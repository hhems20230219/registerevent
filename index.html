<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>活動報名表單</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body style="font-family: sans-serif; padding: 20px">
  <h2>活動報名</h2>

  <label>活動名稱：</label><br>
  <input type="text" id="eventValue" placeholder="輸入活動名稱"><br><br>

  <label>姓名：</label><br>
  <input type="text" id="nameValue" placeholder="輸入姓名"><br><br>

  <label>備註：</label><br>
  <input type="text" id="noteValue" placeholder="可填可不填"><br><br>

  <button id="submitBtn">送出報名</button>

  <script>
    const apiUrl = "https://script.google.com/macros/s/你的ID/exec"; // ⚠️請改成你自己的 GAS Web App URL

    document.querySelector('#submitBtn').addEventListener('click', function () {
      let name = document.querySelector('#nameValue').value.trim();
      let event = document.querySelector('#eventValue').value.trim();
      let note = document.querySelector('#noteValue').value.trim();

      if (!name || !event) {
        alert("請填寫活動名稱與姓名");
        return;
      }

      $.ajax({
        url: apiUrl,
        method: 'GET',
        data: {
          name: name,
          event: event,
          note: note,
          status: "已報名"
        },
        success: function (response) {
          if (response === "成功") {
            alert("報名成功！");
            document.querySelector('#nameValue').value = "";
            document.querySelector('#eventValue').value = "";
            document.querySelector('#noteValue').value = "";
          } else {
            alert("回傳訊息：" + response);
          }
        },
        error: function () {
          alert("送出失敗，請稍後再試");
        }
      });
    });
  </script>
</body>
</html>
